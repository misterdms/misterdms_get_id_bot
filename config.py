#!/usr/bin/env python3
"""
Topics Scanner Bot v5.16 - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–ü—Ä–æ—Å—Ç–æ–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–ø–∏–∫–æ–≤
"""

import os
import logging

# === –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò ===
BOT_TOKEN = os.getenv('BOT_TOKEN')
API_ID = int(os.getenv('API_ID', '0'))
API_HASH = os.getenv('API_HASH', '')

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
if not all([BOT_TOKEN, API_ID, API_HASH]):
    raise ValueError("‚ùå –ù–µ –∑–∞–¥–∞–Ω—ã BOT_TOKEN, API_ID, API_HASH")

# === –ë–ê–ó–ê –î–ê–ù–ù–´–• ===
DATABASE_URL = os.getenv('DATABASE_URL', 'sqlite:///topics_bot.db')

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ PostgreSQL URL
if DATABASE_URL and DATABASE_URL.startswith(('postgres://', 'postgresql://')):
    DB_TYPE = 'postgresql'
else:
    DB_TYPE = 'sqlite'

# === –í–ï–ë-–°–ï–†–í–ï–† ===
PORT = int(os.getenv('PORT', '10000'))

# === –ù–ê–°–¢–†–û–ô–ö–ò –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø ===
LOG_LEVEL = os.getenv('LOG_LEVEL', 'INFO')

def setup_logging():
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"""
    logging.basicConfig(
        level=getattr(logging, LOG_LEVEL),
        format='%(asctime)s | %(levelname)s | %(message)s',
        handlers=[logging.StreamHandler()]
    )
    return logging.getLogger()

logger = setup_logging()

# === –¢–ï–ö–°–¢–´ –°–û–û–ë–©–ï–ù–ò–ô ===
MESSAGES = {
    'welcome': """ü§ñ **Topics Scanner Bot v5.16**

–ü—Ä–∏–≤–µ—Ç! –í—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:

ü§ñ **Bot API** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
üë§ **User API** - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ç–æ–ø–∏–∫–∞–º

–ö–æ–º–∞–Ω–¥–∞ /find_ids —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–∞—Ö.""",
    
    'bot_api_selected': """ü§ñ **Bot API —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω**

‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –ú–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ –≤—Å–µ —Ç–æ–ø–∏–∫–∏

üìã **–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
‚Ä¢ /find_ids - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ø–∏–∫–∏ (–≤ –≥—Ä—É–ø–ø–µ)
‚Ä¢ /start - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏""",
    
    'user_api_setup': """üë§ **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ User API**

–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –Ω—É–∂–Ω—ã —Ç–≤–æ–∏ API –¥–∞–Ω–Ω—ã–µ:

1. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ https://my.telegram.org
2. –í–æ–π–¥–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç
3. API development tools
4. –°–æ–∑–¥–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
5. –û—Ç–ø—Ä–∞–≤—å –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```
12345678
a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6
```
(API_ID –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ, API_HASH –≤–æ –≤—Ç–æ—Ä–æ–π)""",
    
    'user_api_saved': """‚úÖ **User API –Ω–∞—Å—Ç—Ä–æ–µ–Ω!**

–¢–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ.

üìã **–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
‚Ä¢ /find_ids - –ø–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤ (–≤ –≥—Ä—É–ø–ø–µ)
‚Ä¢ /start - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏""",
    
    'find_ids_group_only': """‚ö†Ô∏è **–ö–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–∞—Ö!**

–ü–µ—Ä–µ–π–¥–∏ –≤ –Ω—É–∂–Ω—É—é —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø—É –∏ –æ—Ç–ø—Ä–∞–≤—å –∫–æ–º–∞–Ω–¥—É —Ç–∞–º.""",
    
    'scanning_topics': """üîç **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–æ–≤...**

–ü–æ–¥–æ–∂–¥–∏ –Ω–µ–º–Ω–æ–≥–æ, –ø–æ–ª—É—á–∞—é –¥–∞–Ω–Ω—ã–µ...""",
    
    'no_topics_found': """‚ùå **–¢–æ–ø–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã**

–í–æ–∑–º–æ–∂–Ω–æ:
‚Ä¢ –ì—Ä—É–ø–ø–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ–æ—Ä—É–º–æ–º
‚Ä¢ –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Bot API (–ø–æ–ø—Ä–æ–±—É–π User API)""",
    
    'error_occurred': """‚ùå **–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞**

{error}

–ü–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ –∏–ª–∏ —Å–º–µ–Ω–∏ —Ä–µ–∂–∏–º API."""
}

# === –ö–ù–û–ü–ö–ò –ú–ï–ù–Æ ===
BUTTONS = {
    'main_menu': [
        [('ü§ñ Bot API', 'bot_api'), ('üë§ User API', 'user_api')],
        [('‚ÑπÔ∏è –ü–æ–º–æ—â—å', 'help')]
    ],
    
    'settings_menu': [
        [('üîÑ –°–º–µ–Ω–∏—Ç—å —Ä–µ–∂–∏–º', 'change_mode')],
        [('üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'main_menu')]
    ],
    
    'back_to_main': [
        [('üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'main_menu')]
    ]
}

# === –í–ï–†–°–ò–Ø ===
VERSION = "5.16"
APP_NAME = "Topics Scanner Bot"
